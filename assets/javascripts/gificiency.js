// Generated by CoffeeScript 1.6.3
(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};this.Gificiency=function(){function t(t){this.options=t;this.injectPopup=e(this.injectPopup,this);this.init()}t.prototype.init=function(){this.setDefaultSettings();this.categories=[];this.parseCategories();this.setFilterList();this.getHash()&&this.search(this.getHash());return this.events()};t.prototype.setDefaultSettings=function(){this.settings={delimiter:"-",searchField:$(".search"),imageClass:"card",items:$(".categories li"),links:$(".link"),filter:$(".filter"),filterToggle:$(".filter-toggle"),filterLink:$(".filter-link"),filterList:$(".filter-list"),filterItem:$(".filter-item"),filterActiveClass:"is-expanded"};return $.extend(this.settings,this.options)};t.prototype.events=function(){var e,t=this;this.settings.searchField.on("keyup",function(e){return t.search($(e.currentTarget).val())});e=_.throttle(this.injectPopup,500);this.settings.items.on("mouseover","a",function(t){var n,r;n=$(t.currentTarget);r=n.attr("href");return e(n,r)}).on("mouseout",function(){return t.clearImages()});this.settings.filterToggle.on("click",function(e){e.preventDefault();return t.settings.filter.toggleClass(t.settings.filterActiveClass)});return $(".filter-link").on("click",function(e){var t;e.preventDefault();t=$(e.currentTarget).attr("href");window.location.href=""+t;return location.reload()})};t.prototype.parseCategories=function(){var e;e=this;return this.settings.items.each(function(){var t,n;n=$(this);t=e.getCategory(n.text());if(t!=null){e.categories.push(t);return n.addClass("category category--"+t)}return n.addClass("category category--none")})};t.prototype.listCategories=function(){var e,t,n,r,i;r=this.categories;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(e)}return i};t.prototype.getCategory=function(e){if(~e.indexOf(this.settings.delimiter))return this.trimCategory(e.split(this.settings.delimiter)[0].split(".")[0])};t.prototype.trimCategory=function(e){return e.replace(/(\r\n|\n|\r)/gm,"").replace(/\s/g,"")};t.prototype.setFilterList=function(){var e,t=this;e=this.settings.filterList;return $.each(this.listCategories(!0),function(t,n){return e.append("<li class='filter-item filter-item--"+n+"'>          <a class='filter-link' href='#"+n+"'>"+n+"</a>         </li>")})};t.prototype.injectPopup=function(e,t){return e.parent().append(this.popup(t))};t.prototype.popup=function(e){return $("<img class='"+this.settings.imageClass+"' src='"+e+"'' />")};t.prototype.clearImages=function(){return $("img").each(function(){return $(this).remove()})};t.prototype.search=function(e){return this.settings.links.each(function(){var t;t=$(this);return t.text().search(new RegExp(e,"i"))<0?t.hide():t.show()})};t.prototype.getHash=function(){return window.location.hash!==""?window.location.hash.substring(1):!1};return t}()}).call(this);